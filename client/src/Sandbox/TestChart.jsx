import { useEffect, useRef } from "react";
import { createChart } from "lightweight-charts";
// npm i lightweight-charts@^4.2.3 <- USE THIS VERSION

const candles = [
  {
    time: 1748899860,
    open: 4.333489999999999,
    high: 4.713391682025564,
    low: 4.333489999999999,
    close: 4.422682334266037,
  },
  {
    time: 1748899920,
    open: 4.422682334266037,
    high: 4.502251133308264,
    low: 4.422682334266037,
    close: 4.502251133308264,
  },
  {
    time: 1748900040,
    open: 4.502251133308264,
    high: 4.569977493957734,
    low: 4.502251133308264,
    close: 4.569977493957734,
  },
  {
    time: 1748900100,
    open: 4.569977493957734,
    high: 6.795693697791973,
    low: 4.569977493957734,
    close: 6.795693697791973,
  },
  {
    time: 1748900160,
    open: 6.795693697791973,
    high: 8.188303836021504,
    low: 6.795693697791973,
    close: 8.121024847121497,
  },
  {
    time: 1748900220,
    open: 8.121024847121497,
    high: 8.335639087252588,
    low: 8.121024847121497,
    close: 8.237033712390154,
  },
  {
    time: 1748900280,
    open: 8.237033712390154,
    high: 8.276642117744164,
    low: 7.64887944265874,
    close: 7.64887944265874,
  },
  {
    time: 1748900340,
    open: 7.64887944265874,
    high: 8.30344048038728,
    low: 7.64887944265874,
    close: 8.30344048038728,
  },
  {
    time: 1748900400,
    open: 8.30344048038728,
    high: 8.804503413876478,
    low: 8.30344048038728,
    close: 8.804503413876478,
  },
  {
    time: 1748900460,
    open: 8.804503413876478,
    high: 8.923608342241964,
    low: 8.804503413876478,
    close: 8.923608342241964,
  },
  {
    time: 1748900580,
    open: 8.923608342241964,
    high: 8.522638212828726,
    low: 7.920726940031882,
    close: 7.920726940031882,
  },
  {
    time: 1748900640,
    open: 7.920726940031882,
    high: 7.997482530724798,
    low: 7.920726940031882,
    close: 7.997482530724798,
  },
  {
    time: 1748900700,
    open: 7.997482530724798,
    high: 7.713988646282399,
    low: 7.713988646282399,
    close: 7.713988646282399,
  },
  {
    time: 1748900760,
    open: 7.713988646282399,
    high: 7.3850350166721475,
    low: 7.132631374084968,
    close: 7.181720252448489,
  },
  {
    time: 1748900820,
    open: 7.181720252448489,
    high: 7.76573529164818,
    low: 7.181720252448489,
    close: 7.76573529164818,
  },
  {
    time: 1748900880,
    open: 7.76573529164818,
    high: 8.153373125658659,
    low: 7.76573529164818,
    close: 8.153373125658659,
  },
  {
    time: 1748900940,
    open: 8.153373125658659,
    high: 8.41273213054712,
    low: 8.153373125658659,
    close: 8.41273213054712,
  },
  {
    time: 1748901000,
    open: 8.41273213054712,
    high: 10.84937604443627,
    low: 8.380560130062245,
    close: 10.84937604443627,
  },
  {
    time: 1748901060,
    open: 10.84937604443627,
    high: 10.713903391998526,
    low: 10.713903391998526,
    close: 10.713903391998526,
  },
  {
    time: 1748901120,
    open: 10.713903391998526,
    high: 10.841630565735773,
    low: 10.607614656408483,
    close: 10.841630565735773,
  },
  {
    time: 1748901180,
    open: 10.841630565735773,
    high: 10.850231939031481,
    low: 10.841630565735773,
    close: 10.850231939031481,
  },
  {
    time: 1748901240,
    open: 10.850231939031481,
    high: 11.059380604615574,
    low: 10.850231939031481,
    close: 11.059380604615574,
  },
  {
    time: 1748901300,
    open: 11.059380604615574,
    high: 11.04749418644747,
    low: 10.602465232602562,
    close: 10.602465232602562,
  },
  {
    time: 1748901360,
    open: 10.602465232602562,
    high: 10.593135170515318,
    low: 10.593135170515318,
    close: 10.593135170515318,
  },
  {
    time: 1748901420,
    open: 10.593135170515318,
    high: 10.55018044063811,
    low: 9.54016914759099,
    close: 9.54016914759099,
  },
  {
    time: 1748901660,
    open: 9.54016914759099,
    high: 9.726301263601783,
    low: 9.54016914759099,
    close: 9.726301263601783,
  },
  {
    time: 1748901720,
    open: 9.726301263601783,
    high: 9.898453825255967,
    low: 9.726301263601783,
    close: 9.898453825255967,
  },
  {
    time: 1748901780,
    open: 9.898453825255967,
    high: 9.939510406489346,
    low: 9.898453825255967,
    close: 9.939510406489346,
  },
  {
    time: 1748901900,
    open: 9.939510406489346,
    high: 10.06403647709613,
    low: 9.939510406489346,
    close: 10.06403647709613,
  },
  {
    time: 1748901960,
    open: 10.06403647709613,
    high: 10.159958310494261,
    low: 10.06403647709613,
    close: 10.159958310494261,
  },
  {
    time: 1748902020,
    open: 10.159958310494261,
    high: 10.269698590689831,
    low: 10.159958310494261,
    close: 10.269698590689831,
  },
  {
    time: 1748902080,
    open: 10.269698590689831,
    high: 10.318193629488766,
    low: 10.269698590689831,
    close: 10.318193629488766,
  },
  {
    time: 1748902260,
    open: 10.318193629488766,
    high: 10.344693615469625,
    low: 10.318193629488766,
    close: 10.344693615469625,
  },
  {
    time: 1748902440,
    open: 10.344693615469625,
    high: 10.937212324252569,
    low: 10.344693615469625,
    close: 10.937212324252569,
  },
  {
    time: 1748902500,
    open: 10.937212324252569,
    high: 10.937212324482056,
    low: 10.937212324252569,
    close: 10.937212324482056,
  },
  {
    time: 1748902620,
    open: 10.937212324482056,
    high: 11.028287200106634,
    low: 10.937212324482056,
    close: 10.976363814564218,
  },
  {
    time: 1748902740,
    open: 10.976363814564218,
    high: 11.480527998212493,
    low: 10.976363814564218,
    close: 11.480527998212493,
  },
  {
    time: 1748902800,
    open: 11.480527998212493,
    high: 11.775685278597615,
    low: 11.480527998212493,
    close: 11.775685278597615,
  },
  {
    time: 1748902860,
    open: 11.775685278597615,
    high: 11.96505154545918,
    low: 11.775685278597615,
    close: 11.96505154545918,
  },
  {
    time: 1748902920,
    open: 11.96505154545918,
    high: 12.092575990513073,
    low: 11.96505154545918,
    close: 12.092575990513073,
  },
  {
    time: 1748902980,
    open: 12.092575990513073,
    high: 12.261597582867404,
    low: 12.092575990513073,
    close: 12.261597582867404,
  },
  {
    time: 1748903040,
    open: 12.261597582867404,
    high: 12.404385945504476,
    low: 12.261597582867404,
    close: 12.404385945504476,
  },
  {
    time: 1748903100,
    open: 12.404385945504476,
    high: 12.428861645052152,
    low: 11.928083601878031,
    close: 11.928083601878031,
  },
  {
    time: 1748903160,
    open: 11.928083601878031,
    high: 11.999313338736224,
    low: 11.928083601878031,
    close: 11.93032257062804,
  },
  {
    time: 1748903220,
    open: 11.93032257062804,
    high: 11.77668907094736,
    low: 11.57379582042792,
    close: 11.57379582042792,
  },
  {
    time: 1748903340,
    open: 11.57379582042792,
    high: 11.741626448104673,
    low: 11.57379582042792,
    close: 11.741626448104673,
  },
  {
    time: 1748903400,
    open: 11.741626448104673,
    high: 12.19091828272431,
    low: 11.741626448104673,
    close: 12.19091828272431,
  },
  {
    time: 1748903580,
    open: 12.19091828272431,
    high: 12.481253385564422,
    low: 12.19091828272431,
    close: 12.481253385564422,
  },
  {
    time: 1748903700,
    open: 12.481253385564422,
    high: 12.43489157622858,
    low: 12.070679904813957,
    close: 12.070679904813957,
  },
  {
    time: 1748903820,
    open: 12.070679904813957,
    high: 12.120619456001387,
    low: 12.070679904813957,
    close: 12.120619456001387,
  },
  {
    time: 1748904060,
    open: 12.120619456001387,
    high: 12.554968755710027,
    low: 12.120619456001387,
    close: 12.554968755710027,
  },
  {
    time: 1748904120,
    open: 12.554968755710027,
    high: 12.635745340918708,
    low: 12.554968755710027,
    close: 12.635745340918708,
  },
  {
    time: 1748904180,
    open: 12.635745340918708,
    high: 12.734153540373073,
    low: 12.635745340918708,
    close: 12.734153540373073,
  },
  {
    time: 1748904240,
    open: 12.734153540373073,
    high: 12.482870223975622,
    low: 12.290554938460634,
    close: 12.290554938460634,
  },
  {
    time: 1748904360,
    open: 12.290554938460634,
    high: 12.339257376144351,
    low: 12.290554938460634,
    close: 12.339257376144351,
  },
  {
    time: 1748904480,
    open: 12.339257376144351,
    high: 12.244445543244488,
    low: 12.244445543244488,
    close: 12.244445543244488,
  },
  {
    time: 1748904600,
    open: 12.244445543244488,
    high: 12.196477730057316,
    low: 11.95381576756772,
    close: 11.95381576756772,
  },
  {
    time: 1748904840,
    open: 11.95381576756772,
    high: 12.22811797047938,
    low: 11.95381576756772,
    close: 12.22811797047938,
  },
  {
    time: 1748904900,
    open: 12.22811797047938,
    high: 12.7133386951098,
    low: 12.22811797047938,
    close: 12.7133386951098,
  },
  {
    time: 1748905560,
    open: 12.7133386951098,
    high: 13.133474380193311,
    low: 12.445586531742611,
    close: 14,
  },
];

const TestChart = ({ ca = "9P1qxcUKQUJRtTL84duQrzqpePUbcJMV3WaHJFMfpump" }) => {
  const chartContainerRef = useRef(null);
  useEffect(() => {
    const renderChart = () => {
      const chart = createChart(chartContainerRef.current, {
        layout: {
          background: { type: "solid", color: "#000" },
          textColor: "#000",
        },
        height: 400,
        grid: {
          vertLines: { color: "#000" },
          horzLines: { color: "#000" },
        },
        rightPriceScale: {
          borderVisible: false,
          textColor: "#181818",
          scaleMargins: {
            top: 0.2,
            bottom: 0.15,
          },
        },
        timeScale: {
          borderVisible: false,
          timeVisible: true,
          secondsVisible: false,
        },
      });

      const candleSeries = chart.addCandlestickSeries();
      candleSeries.setData(candles);
      return () => chart.remove();
    };

    renderChart();
  }, [ca]);

  return <div ref={chartContainerRef} className="w-80 sm:w-120" />;
};

export default TestChart;
